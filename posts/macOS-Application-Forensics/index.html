<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="macOS Application Forensics" /><meta property="og:locale" content="en" /><meta name="description" content="Background and Setup When investigating installed applications on macOS, the artifacts will likely be contained within either a Property List (.plist) file or an SQLite file. Both of these files are common across Apple’s ecosystem, including it’s mobile and IoT operating systems." /><meta property="og:description" content="Background and Setup When investigating installed applications on macOS, the artifacts will likely be contained within either a Property List (.plist) file or an SQLite file. Both of these files are common across Apple’s ecosystem, including it’s mobile and IoT operating systems." /><link rel="canonical" href="https://hamishthepiper.github.io/posts/macOS-Application-Forensics/" /><meta property="og:url" content="https://hamishthepiper.github.io/posts/macOS-Application-Forensics/" /><meta property="og:site_name" content="Title Goes Here" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-16T16:41:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="macOS Application Forensics" /><meta name="twitter:site" content="@securitypiper" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-16T16:41:00+00:00","datePublished":"2022-06-16T16:41:00+00:00","description":"Background and Setup When investigating installed applications on macOS, the artifacts will likely be contained within either a Property List (.plist) file or an SQLite file. Both of these files are common across Apple’s ecosystem, including it’s mobile and IoT operating systems.","headline":"macOS Application Forensics","mainEntityOfPage":{"@type":"WebPage","@id":"https://hamishthepiper.github.io/posts/macOS-Application-Forensics/"},"url":"https://hamishthepiper.github.io/posts/macOS-Application-Forensics/"}</script><title>macOS Application Forensics | Title Goes Here</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Title Goes Here"><meta name="application-name" content="Title Goes Here"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://pbs.twimg.com/profile_images/1168251974313271296/iWNDT6-d_400x400.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Title Goes Here</a></div><div class="site-subtitle font-italic">This is a blog about DFIR and IT in general, I make no promises as to the regularity of updates... ¯\_(ツ)_/¯</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/hamishthepiper" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/securitypiper" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>macOS Application Forensics</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>macOS Application Forensics</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/hamishthepiper">James S.</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1655397660" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-16 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="501 words"> <em>2 min</em> read</span></div></div></div><div class="post-content"><h2 id="background-and-setup"><span class="mr-2">Background and Setup</span><a href="#background-and-setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>When investigating installed applications on macOS, the artifacts will likely be contained within either a <a href="https://en.wikipedia.org/wiki/Property_list">Property List</a> (<code class="language-plaintext highlighter-rouge">.plist</code>) file or an <a href="https://www.sqlite.org/index.html">SQLite</a> file. Both of these files are common across Apple’s ecosystem, including it’s mobile and IoT operating systems.</p><p>The best platform to examine macOS applications is from a macOS system. Installing <a href="https://developer.apple.com/xcode/resources/">Xcode</a> developer tools for macOS will give the ability to read both types of plist files, and a FOSS tool like <a href="https://sqlitebrowser.org/dl/">DB Browser for SQLite</a> will allow opening and exploring SQLite files and doing queries on data in different tables.</p><h2 id="where-to-look"><span class="mr-2">Where To Look</span><a href="#where-to-look" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Tools are great, but you have to know where to point them to get the answers you need. By default, macOS uses <a href="https://support.apple.com/en-us/HT204899">System Integrity Protection</a> to limit <strong>3rd party</strong> installers to the following directories:</p><ul><li><code class="language-plaintext highlighter-rouge">/Applications</code><li><code class="language-plaintext highlighter-rouge">/Library</code><li><code class="language-plaintext highlighter-rouge">/usr/local</code></ul><p>This means that if you are examining an <strong>Apple Native</strong> application such as Safari, there might be artifacts outside these locations. These files are hidden by default when viewing with Unix-type OSes. With macOS, <code class="language-plaintext highlighter-rouge">CMD + SHIFT + .</code> while in the Finder window will show hidden system files.</p><h3 id="the-home-directory"><span class="mr-2">The Home Directory</span><a href="#the-home-directory" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The user’s home directory (~) usually contains the bulk of forensically-relevant files for specific applications. Some programs use “dotfiles” (files or directories prepended with <code class="language-plaintext highlighter-rouge">.</code> which are hidden) which are at the root of the user’s directory, and could contain relevant information.</p><p><img data-src="/assets/images/Pasted%20image%2020220613212422.png" alt="Hidden folder for Visual Studio Code" data-proofer-ignore></p><h4 id="library"><span class="mr-2">~/Library</span><a href="#library" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>The user’s Library directory is where most application-specific files are found. There are several supporting directories.</p><p>First, the application will have a discrete place in the user’s Library directory.</p><p><img data-src="/assets/images/Pasted%20image%2020220613222840.png" alt="" data-proofer-ignore></p><p>The above screenshot is the directory for the Reminders application. There are several SQLite database files in sub-directories as well as a plist file. Double-clicking on the .plist file with Xcode tools installed will show the contents whether it is a regular or binary format.</p><p><img data-src="/assets/images/Pasted%20image%2020220613223534.png" alt="" data-proofer-ignore></p><blockquote><p>In this case, the <code class="language-plaintext highlighter-rouge">AccountInformation.plist</code> file contains no relevant information.</p></blockquote><p>However the Files directory contains attachments embedded within individual entries. <img data-src="/assets/images/Pasted%20image%2020220613223734.png" alt="" data-proofer-ignore></p><p>And the Stores directory contains SQLite files. <img data-src="/assets/images/Pasted%20image%2020220613221659.png" alt="" data-proofer-ignore></p><p>Opening the <code class="language-plaintext highlighter-rouge">Data-local.sqlite</code> file with DB Browser for SQLite will let us see that data. <img data-src="/assets/images/Screen%20Shot%202022-06-16%20at%2012.03.32.png" alt="" data-proofer-ignore></p><p>Clicking on the ‘Brows Data’ button will then show a list of tables that can be selected to view the contents. <img data-src="/assets/images/Screen%20Shot%202022-06-16%20at%2012.03.03.png" alt="" data-proofer-ignore> Each table will contain either a standard database with schema, or a binary blob which can be exported and viewed externally. The contents of these SQLite and plist files will vary depending on the application. We’ll explore these in depth in another article.</p><h2 id="application-sandboxing"><span class="mr-2">Application Sandboxing</span><a href="#application-sandboxing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The other thing to be aware of is that macOS applications are run in a sandbox. Sandboxed applications are loaded only with permissions granted to it, and a virtual environment is created for the application which mimics the directory structure on disk via <em>aliased directories</em> which have permissions set for read and/or write.</p><p>Two main folders used are in the User’s Library folder:</p><ul><li><code class="language-plaintext highlighter-rouge">~/Library/Containers</code><li><code class="language-plaintext highlighter-rouge">~/Library/Group Containers</code></ul><p><img data-src="/assets/images/Pasted%20image%2020220616122159.png" alt="" data-proofer-ignore></p><p>These aliased folders will give access to other parts of the file system when the application requests it and the user grants permission.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/dfir/'>DFIR</a>, <a href='/categories/macos/'>macOS</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/sqlite/" class="post-tag no-text-decoration" >sqlite</a> <a href="/tags/plist/" class="post-tag no-text-decoration" >plist</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=macOS Application Forensics - Title Goes Here&amp;url=https://hamishthepiper.github.io/posts/macOS-Application-Forensics/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=macOS Application Forensics - Title Goes Here&amp;u=https://hamishthepiper.github.io/posts/macOS-Application-Forensics/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://hamishthepiper.github.io/posts/macOS-Application-Forensics/&amp;text=macOS Application Forensics - Title Goes Here" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/hello-world/">Hello World</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/info/">info</a> <a class="post-tag" href="/tags/plist/">plist</a> <a class="post-tag" href="/tags/sqlite/">sqlite</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/hello-world/"><div class="card-body"> <em class="timeago small" data-ts="1653925980" > 2022-05-30 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hello World</h3><div class="text-muted small"><p> Hello World This is the first post on my static site! I’ll be using this platform to post up some humble musings and information that some might find useful. In particular, I know that many are i...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/hello-world/" class="btn btn-outline-primary" prompt="Older"><p>Hello World</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/hamishthepiper">James S.</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/info/">info</a> <a class="post-tag" href="/tags/plist/">plist</a> <a class="post-tag" href="/tags/sqlite/">sqlite</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
